<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>第二部分 开始写‘’Hello World‘ | 60分钟学会使用Node.js+Express+mongoDB</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="ggice">
        <meta name="description" content="原文地址[http://cwbuecheler.com/web/tutorials/2013/node-express-mongo/](http://cwbuecheler.com/web/tutorials/2013/node-express-mongo/)">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../part3/创建数据库并存取数据.html" />
        
        
        <link rel="prev" href="../part1/安装依赖.html" />
        

        <meta property="og:title" content="第二部分 开始写‘’Hello World‘ | 60分钟学会使用Node.js+Express+mongoDB">
        <meta property="og:site_name" content="60分钟学会使用Node.js+Express+mongoDB">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/ggice">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="../gitbook/style.css">
        


        
    <div class="book" data-github="ggice/nodejsstart" data-level="2" data-basepath=".." data-revision="1400320139973">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://github.com/ggice/nodejsstart" target="_blank" class="btn pull-left"><i class="fa fa-github-alt"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
	<div class="dropdown-caret">
  <span class="caret-outer"></span>
  <span class="caret-inner"></span>
</div>

	<div class="btn-group btn-block">
		<button id="reduce-font-size" class="btn btn-default">A</button>
		<button id="enlarge-font-size" class="btn btn-default">A</button>
	</div>

	<ul class="list-group font-family-list">
		<li class="list-group-item" data-font="0">Serif</li>
		<li class="list-group-item" data-font="1">Sans</li>
	</ul>

	<div class="btn-group btn-group-xs btn-block color-theme-list">
	  <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
	</div>
</div>

    </span>

    <!-- Actions Right -->
    <a href="#" target="_blank" class="btn pull-right" data-sharing="google-plus"><i class="fa fa-google-plus"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="facebook"><i class="fa fa-facebook"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>

    
    <a href="https://github.com/ggice/nodejsstart/stargazers" target="_blank" class="btn pull-right count-star"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/ggice/nodejsstart/watchers" target="_blank" class="btn pull-right count-watch"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >60分钟学会使用Node.js+Express+mongoDB</a>
    </h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li>
            <a href="https://github.com/ggice" target="blank">About the author</a>
        </li>
        <li>
            <a href="https://github.com/ggice/nodejsstart/issues" target="blank">Questions and Issues</a>
        </li>
        <li>
            <a href="https://github.com/ggice/nodejsstart/edit/master/part2/第二部分 开始写‘’Hello World‘.md" target="blank">Edit and Contribute</a>
        </li>
        <li class="divider"></li>
        
        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="part1/第一部分 15分钟的安装时间.html">
                
                <a href="../part1/第一部分 15分钟的安装时间.html">
                    <i class="fa fa-check"></i> <b>1.</b> 第一部分 15分钟的安装时间
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="1.1" data-path="part1/第一步 安装Node.js.html">
                            
                            <a href="../part1/第一步 安装Node.js.html">
                                <i class="fa fa-check"></i> <b>1.1.</b> 1.1安装Node.js
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.2" data-path="part1/安装Express.html">
                            
                            <a href="../part1/安装Express.html">
                                <i class="fa fa-check"></i> <b>1.2.</b> 1.2安装Express
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.3" data-path="part1/创建一个Express项目.html">
                            
                            <a href="../part1/创建一个Express项目.html">
                                <i class="fa fa-check"></i> <b>1.3.</b> 1.3创建一个Express项目
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.4" data-path="part1/编辑相关内容.html">
                            
                            <a href="../part1/编辑相关内容.html">
                                <i class="fa fa-check"></i> <b>1.4.</b> 1.4编辑相关内容
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.5" data-path="part1/安装依赖.html">
                            
                            <a href="../part1/安装依赖.html">
                                <i class="fa fa-check"></i> <b>1.5.</b> 1.5安装依赖
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="2" data-path="part2/第二部分 开始写‘’Hello World‘.html">
                
                <a href="../part2/第二部分 开始写‘’Hello World‘.html">
                    <i class="fa fa-check"></i> <b>2.</b> 第二部分 开始写‘’Hello World‘
                </a>
                
                
            </li>
        
            <li  data-level="3" data-path="part3/创建数据库并存取数据.html">
                
                <a href="../part3/创建数据库并存取数据.html">
                    <i class="fa fa-check"></i> <b>3.</b> 第三部分 创建数据库并存取数据
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="3.1" data-path="part3/安装MONGODB数据库.html">
                            
                            <a href="../part3/安装MONGODB数据库.html">
                                <i class="fa fa-check"></i> <b>3.1.</b> 3.1安装MONGODB数据库
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.2" data-path="part3/README.html">
                            
                            <a href="../part3/README.html">
                                <i class="fa fa-check"></i> <b>3.2.</b> 3.2运行 MONGOD 和 MONGO
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.3" data-path="part3/建立一个数据库.html">
                            
                            <a href="../part3/建立一个数据库.html">
                                <i class="fa fa-check"></i> <b>3.3.</b> 3.3建立一个数据库
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.4" data-path="part3/添加数据.html">
                            
                            <a href="../part3/添加数据.html">
                                <i class="fa fa-check"></i> <b>3.4.</b> 3.4添加数据
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.5" data-path="part3/链接Mongo和Node.js.html">
                            
                            <a href="../part3/链接Mongo和Node.js.html">
                                <i class="fa fa-check"></i> <b>3.5.</b> 3.5链接Mongo和Node.js
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="4" data-path="part4/第四部分 写入数据库.html">
                
                <a href="../part4/第四部分 写入数据库.html">
                    <i class="fa fa-check"></i> <b>4.</b> 第四部分 写入数据库
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="4.1" data-path="part4/4.1建立数据输入.html">
                            
                            <a href="../part4/4.1建立数据输入.html">
                                <i class="fa fa-check"></i> <b>4.1.</b> 4.1建立数据输入
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.2" data-path="part4/建立数据库函数.html">
                            
                            <a href="../part4/建立数据库函数.html">
                                <i class="fa fa-check"></i> <b>4.2.</b> 4.2建立数据库函数
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.3" data-path="part4/连接并且数据存入数据库.html">
                            
                            <a href="../part4/连接并且数据存入数据库.html">
                                <i class="fa fa-check"></i> <b>4.3.</b> 4.3连接并且数据存入数据库
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="5" data-path="part5/Chapter.html">
                
                <a href="../part5/Chapter.html">
                    <i class="fa fa-check"></i> <b>5.</b> 接下来下一步
                </a>
                
                
            </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 38.888888888888886%;min-width: 33.333333333333336%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../part1/第一部分 15分钟的安装时间.html" title="第一部分 15分钟的安装时间" class="chapter done new-chapter" data-progress="1" style="left: 5.555555555555555%;"></a>
    
        <a href="../part1/第一步 安装Node.js.html" title="1.1安装Node.js" class="chapter done " data-progress="1.1" style="left: 11.11111111111111%;"></a>
    
        <a href="../part1/安装Express.html" title="1.2安装Express" class="chapter done " data-progress="1.2" style="left: 16.666666666666668%;"></a>
    
        <a href="../part1/创建一个Express项目.html" title="1.3创建一个Express项目" class="chapter done " data-progress="1.3" style="left: 22.22222222222222%;"></a>
    
        <a href="../part1/编辑相关内容.html" title="1.4编辑相关内容" class="chapter done " data-progress="1.4" style="left: 27.77777777777778%;"></a>
    
        <a href="../part1/安装依赖.html" title="1.5安装依赖" class="chapter done " data-progress="1.5" style="left: 33.333333333333336%;"></a>
    
        <a href="../part2/第二部分 开始写‘’Hello World‘.html" title="第二部分 开始写‘’Hello World‘" class="chapter done new-chapter" data-progress="2" style="left: 38.888888888888886%;"></a>
    
        <a href="../part3/创建数据库并存取数据.html" title="第三部分 创建数据库并存取数据" class="chapter  new-chapter" data-progress="3" style="left: 44.44444444444444%;"></a>
    
        <a href="../part3/安装MONGODB数据库.html" title="3.1安装MONGODB数据库" class="chapter  " data-progress="3.1" style="left: 50%;"></a>
    
        <a href="../part3/README.html" title="3.2运行 MONGOD 和 MONGO" class="chapter  " data-progress="3.2" style="left: 55.55555555555556%;"></a>
    
        <a href="../part3/建立一个数据库.html" title="3.3建立一个数据库" class="chapter  " data-progress="3.3" style="left: 61.111111111111114%;"></a>
    
        <a href="../part3/添加数据.html" title="3.4添加数据" class="chapter  " data-progress="3.4" style="left: 66.66666666666667%;"></a>
    
        <a href="../part3/链接Mongo和Node.js.html" title="3.5链接Mongo和Node.js" class="chapter  " data-progress="3.5" style="left: 72.22222222222223%;"></a>
    
        <a href="../part4/第四部分 写入数据库.html" title="第四部分 写入数据库" class="chapter  new-chapter" data-progress="4" style="left: 77.77777777777777%;"></a>
    
        <a href="../part4/4.1建立数据输入.html" title="4.1建立数据输入" class="chapter  " data-progress="4.1" style="left: 83.33333333333333%;"></a>
    
        <a href="../part4/建立数据库函数.html" title="4.2建立数据库函数" class="chapter  " data-progress="4.2" style="left: 88.88888888888889%;"></a>
    
        <a href="../part4/连接并且数据存入数据库.html" title="4.3连接并且数据存入数据库" class="chapter  " data-progress="4.3" style="left: 94.44444444444444%;"></a>
    
        <a href="../part5/Chapter.html" title="接下来下一步" class="chapter  new-chapter" data-progress="5" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_1238">
                    
                        <h1 id="-hello-world-">第二部分 开始写‘’Hello World‘</h1>
<p>Fire up your favorite text editor or IDE. I like Sublime Text a lot. Point it at your nodetest1 directory and open app.js. This is kind of the heart of your, well, app. Not a big surprise there. Here&#39;s a breakdown of what you&#39;re going to see:</p>
<p><em>C:\NODE\NODETEST1\APP.JS</em></p>
<pre><code>var express = require(&#39;express&#39;);
var path = require(&#39;path&#39;);
var favicon = require(&#39;static-favicon&#39;);
var logger = require(&#39;morgan&#39;);
var cookieParser = require(&#39;cookie-parser&#39;);
var bodyParser = require(&#39;body-parser&#39;);

var routes = require(&#39;./routes/index&#39;);
var users = require(&#39;./routes/users&#39;);
</code></pre><p>This creates a bunch of basic JavaScript variables and ties them to certain packages, dependencies, node functionality, and routes. Routes are kind of like a combination of models and controllers in this setup – they direct traffic and also contain some programming logic (you can establish a more traditional MVC architecture with Express if you like. That&#39;s outside of the scope of this article). Back when we set up this project, Express created all of this stuff for us. We&#39;re going to totally ignore the user route for now and just work in the top level route (controlled by c:\node\nodetest1\routes\index.js).</p>
<p><em>C:\NODE\NODETEST1\APP.JS</em></p>
<pre><code>var app = express();
</code></pre><p>This one&#39;s important. It instantiates Express and assigns our app variable to it. The next section uses this variable to configure a bunch of Express stuff.</p>
<p><em>C:\NODE\NODETEST1\APP.JS</em></p>
<pre><code>// view engine setup
app.set(&#39;views&#39;, path.join(__dirname, &#39;views&#39;));
app.set(&#39;view engine&#39;, &#39;jade&#39;);

app.use(favicon());
app.use(logger(&#39;dev&#39;));
app.use(bodyParser.json());
app.use(bodyParser.urlencoded());
app.use(cookieParser());
app.use(express.static(path.join(__dirname, &#39;public&#39;)));

app.use(&#39;/&#39;, routes);
app.use(&#39;/users&#39;, users);
</code></pre><p>This tells the app were to find its views, what engine to use to render those views (Jade), and calls a few methods to get things up and running. Note also that the final line is telling Express to serve static objects from the /public/ dir, but to make them actually seem like they&#39;re coming from the top level (it also does this with thei views directory). For example, the images directory is c:\node\nodetest1\public\images … but it is accessed at <a href="http://localhost:3000/images" target="_blank">http://localhost:3000/images</a></p>
<p><em>C:\NODE\NODETEST1\APP.JS</em></p>
<pre><code>/// catch 404 and forwarding to error handler
app.use(function(req, res, next) {
    var err = new Error(&#39;Not Found&#39;);
    err.status = 404;
    next(err);
});

/// error handlers

// development error handler
// will print stacktrace
if (app.get(&#39;env&#39;) === &#39;development&#39;) {
    app.use(function(err, req, res, next) {
        res.status(err.status || 500);
        res.render(&#39;error&#39;, {
            message: err.message,
            error: err
        });
    });
}

// production error handler
// no stacktraces leaked to user
app.use(function(err, req, res, next) {
    res.status(err.status || 500);
    res.render(&#39;error&#39;, {
        message: err.message,
        error: {}
    });
});
</code></pre><p>These are error handlers for development and production (and 404&#39;s). We&#39;re not really worrying about the different between those two right now, but basically if your app is in development mode, your errors will give you more information. Obviously you don&#39;t want to print a stack trace out on a production site that anyone on the web can see.</p>
<p><em>C:\NODE\NODETEST1\APP.JS</em></p>
<pre><code>module.exports = app;
</code></pre><p>A core part of Node is that basically all modules export an object which can easily be called elsewhere in the code. Our master app exports its app object.</p>
<p>Now then, let&#39;s make stuff. We&#39;re not going to just stick &quot;Hello, World!&quot; on our index page. Instead we&#39;re going to use this as an opportunity to learn a bit more about routes and to take a look at how Jade works for putting pages together.</p>
<p>We&#39;re going to start by adding a new app.use directive to app.js. Find the section that looks like this:</p>
<p><em>C:\NODE\NODETEST1\APP.JS</em></p>
<pre><code>app.use(&#39;/&#39;, routes);
app.use(&#39;/users&#39;, users);
</code></pre><p>This directives are telling Express what route files to use. Now, normally I&#39;d advocate setting up separate route files for different parts of your app. For example, the users route file might contain routes for adding users, deleting them, updating them, and so forth, while a new route file called &quot;locations&quot; might handle adding, editing, deleting and displaying location data (in an app for which that was required). In this case, to keep things simple, we&#39;re going to do everything in the index router. That means you can completely ignore the /users line.</p>
<p>Remember that the Express scaffolding already defined the &quot;routes&quot; variable and pointed it at the index router. We&#39;re going to add a &quot;hellworld&quot; method to that router which will render a different page than the default. In your text editor, open up your routes folder, find index.js, and open it. It will look like this:</p>
<p><em>C:\NODE\NODETEST1\ROUTES\INDEX.JS</em></p>
<pre><code>var express = require(&#39;express&#39;);
var router = express.Router();

/* GET home page. */
router.get(&#39;/&#39;, function(req, res) {
    res.render(&#39;index&#39;, { title: &#39;Express&#39; });
});

module.exports = router;
</code></pre><p>Pretty sparse, right? Basically we&#39;re requiring our Express functionality, then attaching a &quot;router&quot; variable to Express&#39;s router method, then using that method when an attempt is made to HTTP get the top level directory of our website. Finally we export our router function back to our app.</p>
<p>We can easily clone that get function for another page, so let&#39;s do that. At the bottom of the file, just above the module.exports line, add this code:</p>
<p><em>C:\NODE\NODETEST1\ROUTES\INDEX.JS</em></p>
<pre><code>/* GET Hello World page. */
router.get(&#39;/helloworld&#39;, function(req, res) {
    res.render(&#39;helloworld&#39;, { title: &#39;Hello, World!&#39; })
});
</code></pre><p>That&#39;s all it takes to handle routing the URI, but we don&#39;t have any actual page for res.render to … render. That&#39;s where Jade comes in. Open up your views folder, and then go ahead and open index.jade. Before you do anything else, save it as helloworld.jade.</p>
<p>Now take a look at the code:</p>
<p><em>C:\NODE\NODETEST1\VIEWS\HELLOWORLD.JADE</em></p>
<pre><code>extends layout

block content
    h1= title
    p Welcome to #{title}
</code></pre><p>This is pretty straightforward. It uses (&quot;extends&quot;) the file layout.jade as a template, and then within the content block defined in the layout file, it sticks a header and a paragraph. Note the use of the &quot;title&quot; variable which we set above, in our index.js route. This means we don&#39;t even have to change the text at all in order for it to show different stuff from the home page. But let&#39;s change it anyway to:</p>
<pre><code>p Hello, World! Welcome to #{title}
</code></pre><p>Save the file, go to your command prompt, ctrl-c to kill your server if it&#39;s already running, and then type:</p>
<p><em>COMMAND C:\NODE\NODETEST1\</em></p>
<pre><code>npm start
</code></pre><p>In order to restart the server. By the way, this seems a good time to mention: changes to Jade templates do not require a server restart, but basically whenever you change a js file, such as app.js or the route files, you&#39;ll need to restart to see changes.</p>
<p>SO … with the server restarted, navigate to <a href="http://localhost:3000/helloworld" target="_blank">http://localhost:3000/helloworld</a> and enjoy the completely asinine text that gets displayed:
<img src="http://cwbuecheler.com/web/tutorials/2013/node-express-mongo/browsershot2.png" alt="">
OK! So now we&#39;ve got our router routing us to our view, which we are viewing. Let&#39;s do some modeling. I&#39;ll give you a moment if you need to fix your hair or makeup.</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../part1/安装依赖.html" class="navigation navigation-prev"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../part3/创建数据库并存取数据.html" class="navigation navigation-next"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        

    
    <script src="../gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

    </body>
</html>
